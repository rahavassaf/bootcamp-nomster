<%= render partial: "render_edit_modal", locals: {place: place} %>

<div class ="textured-border col-10 offset-1">
	
	<!-- toolbox above the place -->
	<div class="place-toolbar">
		<!-- options for logged-in user only -->
		<% if user_signed_in? %>
			<% if current_user.id == place.user_id %>

				<%= link_to '#', data: {toggle: 'modal', target: "#edit_modal_#{place.id}"} do %>
					<i class="fa fa-edit"></i>
				<% end %>

				<!-- Edit via form instead of modal
				< -- %= link_to edit_place_path(:id => place.id) do %>
					<i class="fa fa-edit"></i>
				< -- % end %>
				-->

				<hr class="vertical">

				<%= link_to place_path(:id => place.id), method: :delete, data: {confirm: 'Are you sure you want to delete this?'} do %>
					<i class="fa fa-trash"></i>
			 	<% end %>

			<% else %>
					<i class="fa fa-edit grey-transperant"></i>

					<hr class="vertical">

					<i class="fa fa-trash grey-transperant"></i>
			<% end %>

			<hr class="vertical">

			<!-- #TODO check if the user liked this place -->
			<i class="fa fa-heart red-heart"></i>
			<i class="fa fa-heart grey-transperant"></i>

			<hr class="vertical">

		<% end %>

		<!-- options for all user -->

		<!-- TODO determine ratings -->
		<div class="rating">
			<i class="fa fa-star accent-star"></i>
			<i class="fa fa-star accent-star"></i>
			<i class="fa fa-star-half accent-star" style="margin-right: -1px;"></i>
			<i class="fa fa-star-half grey-star mirror grey-transperant"></i>
			<i class="fa fa-star grey-star grey-transperant"></i>
			<i class="fa fa-star grey-star grey-transperant"></i>
		</div>

		<% unless defined?(@supress_self_link) && @supress_self_link %>
			<hr class="vertical">

			<%= link_to place_path(:id => place.id) do %>
				<i class="fa fa-external-link"></i>
			<% end %>
		<% end %>
	</div>

	<!-- the actual place -->
	<div class="booyah-box">
		<h1><%= place.name %></h1>
		<i><%= place.address %></i><br>
		<p><%= place.description %></p><br>



		<!-- Google map -->
		<% if defined?(@render_map) && @render_map && place.latitude.present? && place.longitude.present? %>
		 
		  <script>
		    function initMap<%= place.id %>() {
		      var map<%= place.id %> = new google.maps.Map(document.getElementById("map<%= place.id %>"), {
		        zoom: 10,
		        center: {lat: <%= place.latitude %>, lng: <%= place.longitude %>},
				zoomControl: true,
				mapTypeControl: false,
				scaleControl: true,
				streetViewControl: false,
				rotateControl: true,
				fullscreenControl: false
		      });

		      var marker<%= place.id %> = new google.maps.Marker({
		        position: {lat: <%= place.latitude %>, lng: <%= place.longitude %>},
		        map: map<%= place.id %>,
		        title: "<%= place.name %>",
		      });
		    }
		  </script>

		  <script async defer
		  src="https://maps.googleapis.com/maps/api/js?key=<%= ENV['GEOCODER_API_KEY'] %>&callback=initMap<%= place.id %>">
		  </script>

		  <div id="map<%= place.id %>" class="map"></div>
		<% end %>
		<!-- / Google map -->

	    <% if place.user.present? %>
	      <small><%= place.user.email %></small>
	    <% end %>
	</div>
</div>